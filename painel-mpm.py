import base64

s = b'CiNjaWEgPSAnG1sxOzM2bScKI2dhYnJpZWwgw6kgaG9tb3NzZXh1YWwKY2wgPSAnG1swbScKYXogPSAnG1sxOzk0bScKY2lhID0gJxtbMTszNm0nCmJhID0gJxtbMTszN20nCnJvID0gJxtbMTszNW0nCnYgPSAnG1sxOzMxbScKCmltcG9ydCByZXF1ZXN0cwppbXBvcnQgb3MKZnJvbSBzeXMgaW1wb3J0IGFyZ3YsIGV4ZWN1dGFibGUKaW1wb3J0IGJhc2U2NAoKCmRlZiByZXN0YXJ0KCk6CiAgICBvcy5leGVjbChleGVjdXRhYmxlLCBleGVjdXRhYmxlLCAqYXJndikKCmRlZiBFbnRlcigpOgogICAgaW5wdXQoIlByZXNzaW9uZSBFTlRFUiBwYXJhIGNvbnRpbnVhciIpCiAgICAKICAgIHJlc3RhcnQoKQoKZGVmIGNsZWFyKCk6CiAgICBvcy5zeXN0ZW0oJ2Nsc3x8Y2xlYXInKQogICAgCgpkZWYgb3Bjb2VzKCk6CiAgICBwcmludChmJycnICAgICAge2JhfeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKdruKXhuKdr+KUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgeKUgXtiYX0KICAgICAgICB7Y2lhfU1JTElDSUEgUElLQSBERSBNRUx7YmF9CiAgICB7YmF9ICDilIHilIHilIHilIHilIHilIHilIHilIHina7il4bina/ilIHilIHilIHilIHilIHilIHilIHilIHilIHilIF7YmF9CiAge2JhfUNSSUFETyBQT1I6IHtyb31TV0FHLE1SRElOSVosU1BZV0FSRXtiYX0KICAgIAogIHtiYX1HSVRIVUI6IFN3YWc2NjZiYWJ5IC8vIFNweXdhcmUwIC8vIG1yZGluaXo4OAogIFpBUDogNTU2Mjk1NTk4MjIwCiAgICAKICBFU0NPTEhBIFVNIE7Dmk1FUk86IAogICAgCiAge2JhfeKUgeKdrntjaWF9MXtiYX3ina/ilIF7Y2lhfSBDT05TVUxUQSBERSBDRVAKICB7YmF94pSB4p2ue2NpYX0ye2JhfeKdr+KUgXtjaWF9IENPTlNVTFRBIERFIElQCiAge2JhfeKUgeKdrntjaWF9M3tiYX3ina/ilIF7Y2lhfSBDT05TVUxUQSBERSBDTlBKCiAge2JhfeKUgeKdrntjaWF9NHtiYX3ina/ilIF7Y2lhfSBDT05TVUxUQSBERSBQTEFDQQogIHtiYX3ilIHina57Y2lhfTV7YmF94p2v4pSBe2NpYX0gQ09OU1VMVEEgREUgVEVMRUZPTkUKICB7YmF94pSB4p2ue2NpYX02e2JhfeKdr+KUgXtjaWF9IENPTlNVTFRBIERFIENQRgogIHtiYX3ilIHina57Y2lhfTd7YmF94p2v4pSBe2NpYX0gQ09OU1VMVEEgREUgTk9NRScnJykKICAgIAogICAgb3BjID0gaW5wdXQoJyAgIOKeo+Keo+KeoyAgICB7fScuZm9ybWF0KGNsKSkKCiAgICBpZiBvcGMgPT0gJzEnOgogICAgCUNlcCgpCgogICAgZWxpZiBvcGMgPT0gJzInOgogICAgCUlwKCkKCiAgICBlbGlmIG9wYyA9PSAnMyc6CiAgICAJQ25waigpCiAgICAJCiAgICBlbGlmIG9wYyA9PSAnNCc6CiAgICAJcGxhY2EoKQogICAgCQogICAgZWxpZiBvcGMgPT0gJzUnOgogICAgCXRlbGVmb25lKCkKICAgIAkKICAgIGVsaWYgb3BjID09ICc2JzoKICAgIAljcGYoKQogICAgCQogICAgZWxpZiBvcGMgPT0gJzcnOgogICAgCW5vbWUoKQogICAgCQogICAgZWxzZToKICAgICAgICByZXN0YXJ0KCkKCgpkZWYgSXAoKToKICAgIGNsZWFyKCkKCiAgICBpcCA9IGlucHV0KGYne2NpYX1ESUdJVEUgTyBJUHtiYX06ICcpCiAKICAgIHIgPSByZXF1ZXN0cy5nZXQoZidodHRwczovL2lwd2hvaXMuYXBwL2pzb24ve2lwfScpCiAgICBkYXRhID0gci5qc29uKCkKICAgIGNsZWFyKCkKICAgIHByaW50KGYne2NpYX1JUHtiYX06IHtkYXRhWyJpcCJdfScpCiAgICBwcmludChmJ3tjaWF9Q09OVElORU5URXtiYX06IHtkYXRhIFsiY29udGluZW50Il19JykKICAgIHByaW50KGYne2NpYX1QQUlTe2JhfToge2RhdGEgWyJjb3VudHJ5Il19JykKICAgIHByaW50KGYne2NpYX1DQVBJVEFMe2JhfToge2RhdGEgWyJjb3VudHJ5X2NhcGl0YWwiXX0nKQogICAgcHJpbnQoZid7Y2lhfUNPRElHTyBERSBBUkVBe2JhfToge2RhdGEgWyJjb3VudHJ5X3Bob25lIl19JykKICAgIHByaW50KGYne2NpYX1FU1RBRE97YmF9OiB7ZGF0YSBbInJlZ2lvbiJdfScpCiAgICBwcmludChmJ3tjaWF9TEFUSVRVREV7YmF9OiB7ZGF0YSBbImxhdGl0dWRlIl19JykKICAgIHByaW50KGYne2NpYX1MT05HSVRVREVERXtiYX06IHtkYXRhIFsibG9uZ2l0dWRlIl19JykKICAgIHByaW50KGYne2NpYX1QUk9WRURPUntiYX06IHtkYXRhIFsiYXNuIl19JykKICAgIEVudGVyKCkKCgpkZWYgQ2VwKCk6CiAgICBjbGVhcigpCiAgICBjZXAgPSBpbnB1dChmJ3tjaWF9RElHSVRFIE8gQ0VQe2JhfTogJykKICAgIGEgPSByZXF1ZXN0cy5nZXQoZidodHRwczovL3ZpYWNlcC5jb20uYnIvd3Mve2NlcH0vanNvbicpCiAgICBjcCA9IGEuanNvbigpCiAgICBjbGVhcigpCiAgICBwcmludChmJ3tjaWF9Q0VQe2JhfToge2NwWyJjZXAiXX0nKQogICAgcHJpbnQoZid7Y2lhfUxPR1JBRE9VUk97YmF9OiB7Y3BbImxvZ3JhZG91cm8iXX0nKQogICAgcHJpbnQoZid7Y2lhfUNPTVBMRU1FTlRPe2JhfToge2NwWyJjb21wbGVtZW50byJdfScpCiAgICBwcmludChmJ3tjaWF9QkFJUlJPe2JhfToge2NwWyJiYWlycm8iXX0nKQogICAgcHJpbnQoZid7Y2lhfUxPQ0FMSURBREV7YmF9OiB7Y3BbImxvY2FsaWRhZGUiXX0nKQogICAgcHJpbnQoZid7Y2lhfVVGe2JhfToge2NwWyJ1ZiJdfScpCiAgICBwcmludChmJ3tjaWF9SUJHRXtiYX06IHtjcFsiaWJnZSJdfScpCiAgICBwcmludChmJ3tjaWF9R0lBe2JhfToge2NwWyJnaWEiXX0nKQogICAgcHJpbnQoZid7Y2lhfURERHtiYX06IHtjcFsiZGRkIl19JykKICAgIHByaW50KGYne2NpYX1TSUFGe2JhfToge2NwWyJzaWFmaSJdfScpCiAgICBFbnRlcigpCgpkZWYgQ25waigpOgogICAgY2xlYXIoKQogICAgY25waiA9IGlucHV0KGYne2NpYX1ESUdJVEUgTyBDTlBKe2JhfTogJykKCQogICAgYiA9IHJlcXVlc3RzLmdldChmJ2h0dHBzOi8vd3d3LnJlY2VpdGF3cy5jb20uYnIvdjEvY25wai97Y25wan0nKQoJCiAgICBwaiA9IGIuanNvbigpCiAgICAKICAgIGNsZWFyKCkKCQogICAgcHJpbnQoZid7Y2lhfU5PTUV7YmF9OiB7cGpbIm5vbWUiXX0nKQogICAgcHJpbnQoZid7Y2lhfUNPTVBMRU1FTlRPe2JhfSA6IHtwalsiY29tcGxlbWVudG8iXX0nKQogICAgcHJpbnQoZid7Y2lhfUFUVUFMSVpBQ0FPIENBREFTVFJBTHtiYX06IHtwalsiZGF0YV9zaXR1YWNhbyJdfScpCiAgICBwcmludChmJ3tjaWF9VElQT3tiYX06IHtwalsidGlwbyJdfScpCiAgICBwcmludChmJ3tjaWF9VEVMRUZPTkV7YmF9OiB7cGpbInRlbGVmb25lIl19JykKICAgIHByaW50KGYne2NpYX1FTUFJTHtiYX06IHtwalsiZW1haWwiXX0nKQogICAgcHJpbnQoZid7Y2lhfVNJVFVBQ0FPe2JhfToge3BqWyJzaXR1YWNhbyJdfScpCiAgICBwcmludChmJ3tjaWF9QkFJUlJPe2JhfToge3BqWyJiYWlycm8iXX0nKQogICAgcHJpbnQoZid7Y2lhfU5VTUVST3tiYX06IHtwalsibnVtZXJvIl19JykKICAgIHByaW50KGYne2NpYX1DRVB7YmF9OiB7cGpbImNlcCJdfScpCiAgICBwcmludChmJ3tjaWF9TVVOSUNJUElPe2JhfToge3BqWyJtdW5pY2lwaW8iXX0nKQogICAgcHJpbnQoZid7Y2lhfURBVEEgREUgQUJFUlRVUkF7YmF9OiB7cGpbImFiZXJ0dXJhIl19JykKICAgIHByaW50KGYne2NpYX1DTlBKe2JhfToge3BqWyJjbnBqIl19JykKICAgIHByaW50KGYne2NpYX1DQVBJVEFMIFNPQ0lBTHtiYX06IHtwalsiY2FwaXRhbF9zb2NpYWwiXX0nKQogICAgRW50ZXIoKQoKZGVmIHBsYWNhKCk6CiAgICBjbGVhcigpCiAgICBwbGFjYSA9IGlucHV0KGYne2NpYX1ESUdJVEUgQSBQTEFDQXtiYX06ICcpCgkKICAgIHUgPSByZXF1ZXN0cy5nZXQoZidodHRwczovL2FwaWNhcnJvcy5jb20vdjEvY29uc3VsdGEve3BsYWNhfS9qc29uJywgdmVyaWZ5PUZhbHNlKQoJCiAgICBwaiA9IHUuanNvbigpCiAgICAKICAgIGNsZWFyKCkKCiAgICAKICAgIHByaW50KGYne2NpYX1BTk97YmF9OiB7cGpbImFubyJdfScpCiAgICBwcmludChmJ3tjaWF9QU5PIE1PREVMT3tiYX06IHtwalsiYW5vTW9kZWxvIl19JykKICAgIHByaW50KGYne2NpYX1DT1J7Y2x9OiB7cGpbImNvciJdfScpCiAgICBwcmludChmJ3tjaWF9Q0hBU1NJe2JhfToge3BqWyJjaGFzc2kiXX0nKQogICAgcHJpbnQoZid7Y2lhfUNPRElHTyBERSBSRVRPUk5Pe2JhfToge3BqWyJjb2RpZ29SZXRvcm5vIl19JykKICAgIHByaW50KGYne2NpYX1DT0RJR08gREUgU0lUVUFDQU97Y2x9OiB7cGpbImNvZGlnb1NpdHVhY2FvIl19JykKICAgIHByaW50KGYne2NpYX1EQVRBe2JhfToge3BqWyJkYXRhIl19JykKICAgIHByaW50KGYne2NpYX1EQVRBIEZVUlRPe2JhfToge3BqWyJkYXRhQXR1YWxpemFjYW9Sb3Vib0Z1cnRvIl19JykKICAgIHByaW50KGYne2NpYX1NQVJDQXtiYX06IHtwalsibWFyY2EiXX0nKQogICAgcHJpbnQoZid7Y2lhfU1PREVMT3tiYX06IHtwalsibW9kZWxvIl19JykKICAgIHByaW50KGYne2NpYX1MT0NBTElEQURFe2JhfToge3BqWyJ1ZiJdfScpCiAgICBwcmludChmJ3tjaWF9UExBQ0F7YmF9OiB7cGpbInBsYWNhIl19JykKICAgIHByaW50KGYne2NpYX1TSVRVQUNBT3tiYX06IHtwalsic2l0dWFjYW8iXX0nKQogICAgcHJpbnQoZid7Y2lhfU1VTklDSVBJT3tiYX06IHtwalsibXVuaWNpcGlvIl19JykKICAgIHByaW50KGYne2NpYX1SRVRPUk5Pe2JhfToge3BqWyJtZW5zYWdlbVJldG9ybm8iXX0nKQogICAgRW50ZXIoKQogICAgCmRlZiB0ZWxlZm9uZSgpOgoJcHJpbnQoZid7dn1PUMOHw4NPIERFU0FCSUxJVEFEQXtjbH0nKQoJCmRlZiBjcGYoKToKCWNsZWFyKCkKCXByaW50KGYne3Z9T1DDh8ODTyBERVNBQklMSVRBREF7Y2x9JykKCUVudGVyKCkKCQpkZWYgbm9tZSgpOgoJY2xlYXIoKQoJcHJpbnQoZid7dn1PUMOHw4NPIERFU0FCSUxJVEFEQXtjbH0nKQoJRW50ZXIoKQoKY2xlYXIoKQoKb3Bjb2VzKCkK'

exec(base64.b64decode(s))